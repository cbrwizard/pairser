<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: SmartParser
  
    &mdash; Documentation by YARD 0.8.7.3
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (S)</a> &raquo;
    
    
    <span class="title">SmartParser</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: SmartParser
  
  
  
</h1>

<dl class="box">
  
  
    
      <dt class="r1">Extended by:</dt>
      <dd class="r1">ActiveSupport::Concern</dd>
      
    
  
    
  
  
    <dt class="r2">Included in:</dt>
    <dd class="r2"><span class='object_link'><a href="Parser.html" title="Parser (module)">Parser</a></span></dd>
    
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">app/controllers/concerns/smart_parser.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>No instructions parser module</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_image_element-instance_method" title="#check_image_element (instance method)">- (Boolean, Watir DOM) <strong>check_image_element</strong>(image_element, src, browser) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tries to locate image element on page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_container_and_text-instance_method" title="#find_container_and_text (instance method)">- (Watir DOM, String) <strong>find_container_and_text</strong>(image_element) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tries to locate good&#39; container and its&#39; heading.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_meta_images-instance_method" title="#find_meta_images (instance method)">- (Array) <strong>find_meta_images</strong>(browser) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finds images in meta tags.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_all_big_images-instance_method" title="#get_all_big_images (instance method)">- (Object) <strong>get_all_big_images</strong>(browser) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets all big images from website.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_without_instructions-instance_method" title="#parse_without_instructions (instance method)">- (Good) <strong>parse_without_instructions</strong>(browser, website) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses a website without instructions from Site.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepare_variables-instance_method" title="#prepare_variables (instance method)">- (Boolean) <strong>prepare_variables</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepares variables for parsing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_image_dublicates-instance_method" title="#remove_image_dublicates (instance method)">- (Array) <strong>remove_image_dublicates</strong>(big_images, main_image_src) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks for a copy of main image in big images.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#smart_create_good-instance_method" title="#smart_create_good (instance method)">- (Good) <strong>smart_create_good</strong>(text, main_image, website, big_images) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a good using all info collected.</p>
</div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check_image_element-instance_method">
  
    - (<tt>Boolean</tt>, <tt>Watir DOM</tt>) <strong>check_image_element</strong>(image_element, src, browser) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>image_exists boolean is used because it works faster than browser checking</p>
</div>
  </div>


<p>Tries to locate image element on page</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>image_element</span>
      
      
        <span class='type'>(<tt>Watir DOM</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul><li>
<p>dom element where image &#39;should&#39; exist</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>src</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul><li>
<p>url of image</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>browser</span>
      
      
        <span class='type'>(<tt>Watir::Browser</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>browser which checks everything</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>image_exists - if image was found in DOM</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>Watir DOM</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>image_element - image DOM element</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_image_element'>check_image_element</span><span class='lparen'>(</span><span class='id identifier rubyid_image_element'>image_element</span><span class='comma'>,</span> <span class='id identifier rubyid_src'>src</span><span class='comma'>,</span> <span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='comment'># Checks if src is broken
</span>  <span class='id identifier rubyid_image_exists'>image_exists</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_image_element'>image_element</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
    <span class='id identifier rubyid_image_exists'>image_exists</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='comment'># Removes http from start of src
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_image_exists'>image_exists</span>
      <span class='id identifier rubyid_image_element'>image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_image'>image</span><span class='lparen'>(</span><span class='label'>src:</span> <span class='id identifier rubyid_src'>src</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?\:</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_image_element'>image_element</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
        <span class='id identifier rubyid_image_exists'>image_exists</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># Removes http and www from start of src
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_image_exists'>image_exists</span>
      <span class='id identifier rubyid_image_element'>image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_image'>image</span><span class='lparen'>(</span><span class='label'>src:</span> <span class='id identifier rubyid_src'>src</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?\:\/\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^www.</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_image_element'>image_element</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
        <span class='id identifier rubyid_image_exists'>image_exists</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># Removes http and www and domain from start of src
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_image_exists'>image_exists</span>
      <span class='id identifier rubyid_image_element'>image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_image'>image</span><span class='lparen'>(</span><span class='label'>src:</span> <span class='id identifier rubyid_src'>src</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?\:\/\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^www.</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='id identifier rubyid_get_host_without_www'>get_host_without_www</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_image_element'>image_element</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
        <span class='id identifier rubyid_image_exists'>image_exists</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_image_exists'>image_exists</span><span class='comma'>,</span> <span class='id identifier rubyid_image_element'>image_element</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_container_and_text-instance_method">
  
    - (<tt>Watir DOM</tt>, <tt>String</tt>) <strong>find_container_and_text</strong>(image_element) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>checks by going up in DOM and looking for headings according to priority
order</p>
</div>
  </div>


<p>Tries to locate good&#39; container and its&#39; heading</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>image_element</span>
      
      
        <span class='type'>(<tt>Watir DOM</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul><li>
<p>dom element where image exists</p>
</li></ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Watir DOM</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>good_container - good container DOM element</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>text - a heading text</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_container_and_text'>find_container_and_text</span><span class='lparen'>(</span><span class='id identifier rubyid_image_element'>image_element</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_good_container'>good_container</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_tmp_parent'>tmp_parent</span> <span class='op'>=</span> <span class='id identifier rubyid_image_element'>image_element</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
  <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='int'>10</span>
    <span class='id identifier rubyid_itemprop_name'>itemprop_name</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span><span class='period'>.</span><span class='id identifier rubyid_element'>element</span><span class='lparen'>(</span><span class='label'>css:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[itemprop=&#39;name&#39;]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_itemprop_name'>itemprop_name</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
      <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_itemprop_name'>itemprop_name</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
      <span class='id identifier rubyid_good_container'>good_container</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span>
      <span class='kw'>break</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_h1'>h1</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span><span class='period'>.</span><span class='id identifier rubyid_h1'>h1</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_h1'>h1</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
        <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_h1'>h1</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
        <span class='id identifier rubyid_good_container'>good_container</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span>
        <span class='kw'>break</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_h2'>h2</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span><span class='period'>.</span><span class='id identifier rubyid_h2'>h2</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_h2'>h2</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
          <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_h2'>h2</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
          <span class='id identifier rubyid_good_container'>good_container</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span>
          <span class='kw'>break</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_h3'>h3</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span><span class='period'>.</span><span class='id identifier rubyid_h3'>h3</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_h3'>h3</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
            <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_h3'>h3</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
            <span class='id identifier rubyid_good_container'>good_container</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_tmp_parent'>tmp_parent</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp_parent'>tmp_parent</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_good_container'>good_container</span><span class='comma'>,</span> <span class='id identifier rubyid_text'>text</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_meta_images-instance_method">
  
    - (<tt>Array</tt>) <strong>find_meta_images</strong>(browser) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>checks for size and type</p>
</div>
  </div>


<p>Finds images in meta tags</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>browser</span>
      
      
        <span class='type'>(<tt>Watir::Browser</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>browser which checks everything</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>meta images array</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 173</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_meta_images'>find_meta_images</span><span class='lparen'>(</span><span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_meta_images'>meta_images</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_metas'>metas</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lparen'>(</span><span class='label'>css:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>meta[property=&#39;og:image&#39;]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_metas'>metas</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_meta_image'>meta_image</span><span class='op'>|</span>
    <span class='id identifier rubyid_src'>src</span> <span class='op'>=</span> <span class='id identifier rubyid_meta_image'>meta_image</span><span class='period'>.</span><span class='id identifier rubyid_attribute_value'>attribute_value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>content</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_meta_images'>meta_images</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'>FastImage</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='symbol'>:+</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_src'>src</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_is_ok_type?'>is_ok_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_is_ok_size?'>is_ok_size?</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_meta_images'>meta_images</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='int'>30</span> <span class='comment'># in case of huge number of images
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_meta_images'>meta_images</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_all_big_images-instance_method">
  
    - (<tt>Object</tt>) <strong>get_all_big_images</strong>(browser) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'>
<p>Ignore images with &#39;logo&#39; in name</p>
</div>
  </div>


<p>Gets all big images from website</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>browser</span>
      
      
        <span class='type'>(<tt>Watir::Browser</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>browser which checks everything</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76
77
78
79
80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_all_big_images'>get_all_big_images</span><span class='lparen'>(</span><span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_big_images'>all_big_images</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_images'>images</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_image'>image</span><span class='op'>|</span>
    <span class='id identifier rubyid_src'>src</span> <span class='op'>=</span> <span class='id identifier rubyid_image'>image</span><span class='period'>.</span><span class='id identifier rubyid_src'>src</span>
    <span class='id identifier rubyid_all_big_images'>all_big_images</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='const'>FastImage</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='symbol'>:+</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_src'>src</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_image'>image</span><span class='period'>.</span><span class='id identifier rubyid_visible?'>visible?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_is_ok_type?'>is_ok_type?</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_is_ok_size?'>is_ok_size?</span><span class='lparen'>(</span><span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_all_big_images'>all_big_images</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;=</span> <span class='int'>30</span> <span class='comment'># in case of huge number of images
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_all_big_images'>all_big_images</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_without_instructions-instance_method">
  
    - (<tt><span class='object_link'><a href="Good.html" title="Good (class)">Good</a></span></tt>) <strong>parse_without_instructions</strong>(browser, website) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>looks for a largest image, then tries to find a common container with a
heading. After that takes other images from that container and grabs images
from meta tags.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>is called from Parser#parse_to_good</p>
</div>
  </div>


<p>Parses a website without instructions from Site</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>browser</span>
      
      
        <span class='type'>(<tt>Watir::Browser</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>browser which checks everything</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>website</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>url of good</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Good.html" title="Good (class)">Good</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>resulting good</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_without_instructions'>parse_without_instructions</span><span class='lparen'>(</span><span class='id identifier rubyid_browser'>browser</span><span class='comma'>,</span> <span class='id identifier rubyid_website'>website</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_main_image_exists'>main_image_exists</span><span class='comma'>,</span> <span class='id identifier rubyid_good_container'>good_container</span><span class='comma'>,</span> <span class='id identifier rubyid_big_images'>big_images</span><span class='comma'>,</span> <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_prepare_variables'>prepare_variables</span>

  <span class='id identifier rubyid_all_big_images'>all_big_images</span> <span class='op'>=</span> <span class='id identifier rubyid_get_all_big_images'>get_all_big_images</span><span class='lparen'>(</span><span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_largest_image'>largest_image</span> <span class='op'>=</span> <span class='id identifier rubyid_all_big_images'>all_big_images</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>

  <span class='comment'># Finds main image
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_largest_image'>largest_image</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_main_image_src'>main_image_src</span> <span class='op'>=</span> <span class='id identifier rubyid_largest_image'>largest_image</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_main_image_element'>main_image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_image'>image</span><span class='lparen'>(</span><span class='label'>src:</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_main_image_exists'>main_image_exists</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image_element'>main_image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_check_image_element'>check_image_element</span><span class='lparen'>(</span><span class='id identifier rubyid_main_image_element'>main_image_element</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='comma'>,</span> <span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If main image dom element was found after all (it may not be found)
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_main_image_exists'>main_image_exists</span>
    <span class='id identifier rubyid_good_container'>good_container</span><span class='comma'>,</span> <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_find_container_and_text'>find_container_and_text</span><span class='lparen'>(</span><span class='id identifier rubyid_main_image_element'>main_image_element</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># If successfully found a goods container
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_good_container'>good_container</span>
    <span class='comment'># Looks for other images in that container
</span>    <span class='id identifier rubyid_all_big_images'>all_big_images</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_image'>image</span><span class='op'>|</span>
      <span class='id identifier rubyid_src'>src</span> <span class='op'>=</span> <span class='id identifier rubyid_image'>image</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_image_element'>image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_good_container'>good_container</span><span class='period'>.</span><span class='id identifier rubyid_image'>image</span><span class='lparen'>(</span><span class='label'>src:</span> <span class='id identifier rubyid_src'>src</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_image_exists'>image_exists</span><span class='comma'>,</span> <span class='id identifier rubyid_image_element'>image_element</span> <span class='op'>=</span> <span class='id identifier rubyid_check_image_element'>check_image_element</span><span class='lparen'>(</span><span class='id identifier rubyid_image_element'>image_element</span><span class='comma'>,</span> <span class='id identifier rubyid_src'>src</span><span class='comma'>,</span> <span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_big_images'>big_images</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_image'>image</span> <span class='kw'>if</span> <span class='id identifier rubyid_image_exists'>image_exists</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_text'>text</span> <span class='op'>=</span> <span class='id identifier rubyid_browser'>browser</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_meta_images'>meta_images</span> <span class='op'>=</span> <span class='id identifier rubyid_find_meta_images'>find_meta_images</span><span class='lparen'>(</span><span class='id identifier rubyid_browser'>browser</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span> <span class='id identifier rubyid_meta_images'>meta_images</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_main_image_exists'>main_image_exists</span>
    <span class='id identifier rubyid_big_images'>big_images</span> <span class='op'>=</span> <span class='id identifier rubyid_remove_image_dublicates'>remove_image_dublicates</span><span class='lparen'>(</span><span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_main_image'>main_image</span> <span class='op'>=</span> <span class='const'>Image</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>website:</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='comment'># Takes main image from additional images
</span>    <span class='id identifier rubyid_main_image'>main_image</span> <span class='op'>=</span> <span class='const'>Image</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>website:</span> <span class='id identifier rubyid_big_images'>big_images</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_smart_create_good'>smart_create_good</span><span class='lparen'>(</span><span class='id identifier rubyid_text'>text</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image'>main_image</span><span class='comma'>,</span> <span class='id identifier rubyid_website'>website</span><span class='comma'>,</span> <span class='id identifier rubyid_big_images'>big_images</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepare_variables-instance_method">
  
    - (<tt>Boolean</tt>) <strong>prepare_variables</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Prepares variables for parsing</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>by default, there is no main image</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>by default, there is no good container</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>by default, there is no other images</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>by default, there is no good heading</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_variables'>prepare_variables</span>
  <span class='kw'>return</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_image_dublicates-instance_method">
  
    - (<tt>Array</tt>) <strong>remove_image_dublicates</strong>(big_images, main_image_src) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>checks for different domains, paths, etc</p>
</div>
  </div>


<p>Checks for a copy of main image in big images</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>big_images</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>array of additional images</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>main_image_src</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>url of main image</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>additional images array</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_image_dublicates'>remove_image_dublicates</span><span class='lparen'>(</span><span class='id identifier rubyid_big_images'>big_images</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_big_images_rel_paths'>big_images_rel_paths</span> <span class='op'>=</span> <span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_img'>img</span><span class='op'>|</span> <span class='id identifier rubyid_img'>img</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?\:\/\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^www.</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='id identifier rubyid_get_host_without_www'>get_host_without_www</span><span class='lparen'>(</span><span class='id identifier rubyid_img'>img</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_main_image_rel_path'>main_image_rel_path</span> <span class='op'>=</span> <span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^https?\:\/\/</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^www.</span><span class='regexp_end'>/</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='id identifier rubyid_get_host_without_www'>get_host_without_www</span><span class='lparen'>(</span><span class='id identifier rubyid_main_image_src'>main_image_src</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span> <span class='id identifier rubyid_big_images_rel_paths'>big_images_rel_paths</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid_main_image_rel_path'>main_image_rel_path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_big_images'>big_images</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="smart_create_good-instance_method">
  
    - (<tt><span class='object_link'><a href="Good.html" title="Good (class)">Good</a></span></tt>) <strong>smart_create_good</strong>(text, main_image, website, big_images) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a good using all info collected</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>heading of good</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>main_image</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>url of main image</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>website</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>url of good</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>big_images</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>array of additional images</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Good.html" title="Good (class)">Good</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>resulting good</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


205
206
207
208
209
210
211
212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/concerns/smart_parser.rb', line 205</span>

<span class='kw'>def</span> <span class='id identifier rubyid_smart_create_good'>smart_create_good</span><span class='lparen'>(</span><span class='id identifier rubyid_text'>text</span><span class='comma'>,</span> <span class='id identifier rubyid_main_image'>main_image</span><span class='comma'>,</span> <span class='id identifier rubyid_website'>website</span><span class='comma'>,</span> <span class='id identifier rubyid_big_images'>big_images</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_good'>good</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='period'>.</span><span class='id identifier rubyid_goods'>goods</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_text'>text</span><span class='comma'>,</span> <span class='label'>main_image_id:</span> <span class='id identifier rubyid_main_image'>main_image</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='label'>website:</span> <span class='id identifier rubyid_website'>website</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first_or_create'>first_or_create</span>
  <span class='id identifier rubyid_main_image'>main_image</span><span class='period'>.</span><span class='id identifier rubyid_good_id'>good_id</span> <span class='op'>=</span> <span class='id identifier rubyid_good'>good</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_main_image'>main_image</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>

  <span class='id identifier rubyid_big_images'>big_images</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_image'>image</span><span class='op'>|</span>
    <span class='const'>Image</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='label'>website:</span> <span class='id identifier rubyid_image'>image</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>good_id:</span> <span class='id identifier rubyid_good'>good</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_good'>good</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Mar 26 17:45:21 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.3 (ruby-2.1.0).
</div>

  </body>
</html>